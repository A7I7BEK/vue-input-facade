os: linux
language: node_js

node_js:
  - node
  - lts/*
  - 10

branches:
  only:
    - master
    - next

install: travis_retry npm install

script:
  - npm test
  - npm run coveralls

before_deploy: npm run build:docs

deploy:
  provider: pages
  local_dir: build
  token: $GH_TOKEN
  skip_cleanup: true
  on:
    node_js: lts/*
    branch: master
    tags: false

jobs:
  include:
    - stage: release
      node_js: lts/*
      script:
        - npm run build:plugin
        - npx semantic-release
